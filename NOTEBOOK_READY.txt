â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘               âœ… KAGGLE NOTEBOOK COMPLETE AND READY! âœ…                        â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¦ FILE DETAILS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Filename:  kaggle_training_notebook.ipynb
  Size:      15.8 KB
  Cells:     20 cells (10 markdown + 10 code)
  Format:    Jupyter Notebook 4.4
  Status:    âœ… VALID and uploadable to Kaggle
ğŸ“‹ NOTEBOOK STRUCTURE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Step 1:  Install Dependencies (einops, lpips, roboflow, etc.)
  Step 2:  Import Libraries (PyTorch, CV2, NumPy, etc.)
  Step 3:  Download Dataset from Roboflow (AUTOMATIC)
  Step 4:  Define Model Architecture (Vision Transformer)
  Step 5:  Dataset with Synthetic Degradation
  Step 6:  Training Configuration (256px, batch 16, 100 epochs)
  Step 7:  Create Datasets and DataLoaders
  Step 8:  Create Model & Optimizer (AdamW, CosineAnnealingLR)
  Step 9:  Training Loop (with PSNR tracking)
  Step 10: Download Trained Model
ğŸ”‘ PRE-CONFIGURED SETTINGS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  âœ… Roboflow API Key:  EBJvHlgSWLyW1Ir6ctkH (hardcoded)
  âœ… Workspace:         neeew
  âœ… Project:           yoyoyo-mptyx-ijqfp
  âœ… Version:           1
  âœ… Dataset Location:  /kaggle/working/dataset (automatic)
âš™ï¸  TRAINING SETTINGS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Image Size:     256x256
  Batch Size:     16
  Epochs:         100
  Model:          ViT (768 dim, 12 layers, 12 heads)
  Optimizer:      AdamW (lr=1e-4, weight_decay=0.01)
  Scheduler:      CosineAnnealingLR
  Loss:           L1Loss
  GPU:            Auto-detected (Kaggle T4)
ğŸ¨ AUTOMATIC FEATURES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  âœ… Dataset download (from Roboflow)
  âœ… Synthetic degradation (noise, blur, aging)
  âœ… Data augmentation (flip, rotate)
  âœ… Directory creation (/kaggle/working/checkpoints)
  âœ… PSNR calculation every 5 epochs
  âœ… Best model auto-save (best_psnr.pth)
  âœ… Periodic checkpoints (every 10 epochs)
  âœ… Final model save (final.pth)
ğŸ“¤ UPLOAD TO KAGGLE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  1. Go to:         https://www.kaggle.com
  2. Click:         "Create" â†’ "New Notebook"
  3. Click:         "File" â†’ "Import Notebook"
  4. Upload:        kaggle_training_notebook.ipynb
  5. Enable GPU:    Settings â†’ Accelerator â†’ GPU T4 x2
  6. Run:           Click "Run All"
  7. Wait:          ~5 hours for training
  8. Download:      /kaggle/working/checkpoints/best_psnr.pth
â±ï¸  EXPECTED TIMELINE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Setup & Install:        2-5 minutes
  Dataset Download:       2-5 minutes
  Training (100 epochs):  ~5 hours
  Total:                  ~5-6 hours
ğŸ“Š EXPECTED RESULTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  After 100 epochs:
  Train Loss:  ~0.05-0.08
  Val Loss:    ~0.06-0.10
  Val PSNR:    28-35 dB (higher is better)
ğŸ’¾ OUTPUT FILES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  /kaggle/working/checkpoints/
  â”œâ”€â”€ best_psnr.pth     â† MAIN FILE (download this!)
  â”œâ”€â”€ final.pth         â† Final epoch
  â”œâ”€â”€ epoch_10.pth      â† Checkpoint at epoch 10
  â”œâ”€â”€ epoch_20.pth      â† Checkpoint at epoch 20
  â””â”€â”€ ...
ğŸ” WHAT TO WATCH DURING TRAINING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  âœ“ Loss decreasing (0.15 â†’ 0.10 â†’ 0.08...)
  âœ“ PSNR increasing (25 â†’ 28 â†’ 31...)
  âœ“ "âœ“ New best PSNR" messages (model improving!)
  âœ“ No errors or NaN values
âŒ TROUBLESHOOTING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Problem                Solution
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Out of memory         â†’ Change BATCH_SIZE to 8 in Step 6
  Dataset download      â†’ Check internet connection
  fails                 â†’ Verify Roboflow API key in Step 3
  No GPU                â†’ Enable GPU in Kaggle settings
  Training too slow     â†’ Verify GPU is enabled
  Notebook won't       â†’ File is valid - try different browser
  upload
âœ… VERIFICATION CHECKLIST
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  [âœ“] Notebook file created (15.8 KB)
  [âœ“] Valid Jupyter format (nbformat 4.4)
  [âœ“] 20 cells total (10 markdown + 10 code)
  [âœ“] Roboflow API hardcoded
  [âœ“] All dependencies listed
  [âœ“] Complete model architecture
  [âœ“] Synthetic degradation pipeline
  [âœ“] Training loop with PSNR
  [âœ“] Auto-checkpointing enabled
  [âœ“] Ready to upload to Kaggle
ğŸ“š DOCUMENTATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Quick Start:        START_HERE.txt
  Quick Reference:    KAGGLE_QUICK_REFERENCE.txt
  Detailed Guide:     KAGGLE_NOTEBOOK_GUIDE.md
  Visual Guide:       KAGGLE_VISUAL_GUIDE.md
  Complete Summary:   KAGGLE_SETUP_COMPLETE.md
  This File:          NOTEBOOK_READY.txt
ğŸ¯ AFTER TRAINING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  1. Download best_psnr.pth from Kaggle output
  2. Copy to your project folder
  3. Use with inference.py for manuscript restoration
  4. Or integrate into your Streamlit app
ğŸ’¡ TIPS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  â€¢ You can stop training early if PSNR > 30 dB (good quality)
  â€¢ Training is automatic - you can close the tab and check back later
  â€¢ Kaggle notebooks auto-save every few minutes
  â€¢ You get 30 hours of free GPU per week on Kaggle
  â€¢ Can resume training by loading a checkpoint
ğŸ‰ SUCCESS INDICATORS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  You'll know it's working when you see:
  Step 3 output:
    ğŸ“¥ Downloading dataset from Roboflow...
    âœ… Dataset downloaded to: /kaggle/working/dataset
    Train: 150 files
  Step 9 output:
    Epoch 1/100: Train Loss=0.1234
    Epoch 5/100: Train Loss=0.1123, Val Loss=0.1045, Val PSNR=27.3
    âœ“ New best PSNR: 27.3
  Final output:
    âœ… Training complete! Best PSNR: 32.45
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘                    ğŸš€ READY TO UPLOAD TO KAGGLE! ğŸš€                          â•‘
â•‘                                                                              â•‘
â•‘                   File: kaggle_training_notebook.ipynb                       â•‘
â•‘                   Size: 15.8 KB                                              â•‘
â•‘                   Status: âœ… VALID                                            â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Created: November 23, 2025
Status: COMPLETE AND VERIFIED
